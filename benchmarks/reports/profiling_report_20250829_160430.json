{
  "attention": {
    "error": "/home/kd/med-vllm/medvllm/layers/attention.py:40: UserWarning: Flash Attention is not installed. Falling back to a simpler attention implementation. For better performance, install flash_attn with: pip install flash-attn --no-build-isolation\n  warnings.warn(\n2025-08-29 16:04:35 - medvllm.engine.model_runner.registry - INFO - Registered default model: biobert-base-cased-v1.2\n2025-08-29 16:04:35 - medvllm.engine.model_runner.registry - INFO - Registered default model: clinical-bert-base-uncased\nusage: benchmark_attention.py [-h] [--seq SEQ] [--heads HEADS] [--dim DIM]\n                              [--batch BATCH] [--iters ITERS]\n                              [--device {auto,cpu,cuda}]\n                              [--dtype {fp32,fp16,bf16}]\n                              [--suite {basic,extended}] [--save [SAVE]]\n                              [--emit-trace] [--trace-dir TRACE_DIR]\n                              [--fusion-compile] [--ffn-bench]\n                              [--ffn-intermediate FFN_INTERMEDIATE]\nbenchmark_attention.py: error: unrecognized arguments: --out /home/kd/med-vllm/benchmarks/benchmark_results_cpu_smoke/attn_cpu_20250829_160430.json --warmup 1"
  },
  "imaging": {
    "device": "cpu",
    "dtype": "fp32",
    "channels_last": false,
    "amp": false,
    "cudnn_benchmark": false,
    "compiled": false,
    "input_shape": [
      2,
      8,
      256,
      256
    ],
    "batches": 2,
    "batch_time_ms": 24.071553496469278,
    "imgs_per_sec": 83.08562221766668,
    "cpu_max_rss_mb": 810.68359375,
    "cuda_max_mem_mb": null,
    "acc_check_enabled": false,
    "has_nan": null,
    "has_inf": null,
    "repeatability_pass": null,
    "max_abs_diff": null,
    "mean_abs_diff": null
  },
  "op_summary_us_top15": [
    {
      "op": "PyTorch Profiler (0)",
      "total_us": 57022
    },
    {
      "op": "aten::conv2d",
      "total_us": 33526
    },
    {
      "op": "aten::convolution",
      "total_us": 33434
    },
    {
      "op": "aten::_convolution",
      "total_us": 33221
    },
    {
      "op": "aten::mkldnn_convolution",
      "total_us": 32999
    },
    {
      "op": "aten::max_pool2d",
      "total_us": 14118
    },
    {
      "op": "aten::max_pool2d_with_indices",
      "total_us": 13964
    },
    {
      "op": "aten::silu",
      "total_us": 4569
    },
    {
      "op": "aten::linear",
      "total_us": 497
    },
    {
      "op": "aten::empty",
      "total_us": 287
    },
    {
      "op": "aten::addmm",
      "total_us": 284
    },
    {
      "op": "aten::adaptive_avg_pool2d",
      "total_us": 205
    },
    {
      "op": "aten::_adaptive_avg_pool2d",
      "total_us": 182
    },
    {
      "op": "aten::t",
      "total_us": 147
    },
    {
      "op": "aten::as_strided_",
      "total_us": 133
    }
  ],
  "meta": {
    "device": "cpu",
    "trace_dir": "/home/kd/med-vllm/benchmarks/profiles",
    "timestamp": "2025-08-29T16:04:48.524287"
  }
}